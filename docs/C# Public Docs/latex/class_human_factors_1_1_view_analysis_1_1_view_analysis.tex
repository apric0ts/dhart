\hypertarget{class_human_factors_1_1_view_analysis_1_1_view_analysis}{}\doxysection{Human\+Factors.\+View\+Analysis.\+View\+Analysis Class Reference}
\label{class_human_factors_1_1_view_analysis_1_1_view_analysis}\index{HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}}


Functions for analyzing the view of an observer in an environment at human scale.  


\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{class_human_factors_1_1_native_utils_1_1_common_native_arrays_1_1_managed_float_array}{Managed\+Float\+Array}} \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_a1cdb30c740e2efd5a1a01ef633c734ac}{View\+Analysis\+Aggregate}} (\mbox{\hyperlink{class_human_factors_1_1_ray_tracing_1_1_embree_b_v_h}{Embree\+B\+VH}} bvh, I\+Enumerable$<$ \mbox{\hyperlink{struct_human_factors_1_1_vector3_d}{Vector3D}} $>$ nodes, int ray\+\_\+count, float upward\+\_\+fov=50.\+0f, float downward\+\_\+fov=70.\+0f, float height=1.\+7f, \mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765c}{View\+Aggregate\+Type}} type=\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765ca16de38737a9f8366e9b2042b4e9b6290}{View\+Aggregate\+Type.\+A\+V\+E\+R\+A\+GE}})
\begin{DoxyCompactList}\small\item\em Conduct view analysis and aggregate the results for each node. \end{DoxyCompactList}\item 
static \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_result_array}{Result\+Array}} \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_aec86f6a5bbc392de04357465994bab39}{View\+Analysis\+Standard}} (\mbox{\hyperlink{class_human_factors_1_1_ray_tracing_1_1_embree_b_v_h}{Embree\+B\+VH}} bvh, I\+Enumerable$<$ \mbox{\hyperlink{struct_human_factors_1_1_vector3_d}{Vector3D}} $>$ nodes, int ray\+\_\+count, float upward\+\_\+fov=50.\+0f, float downward\+\_\+fov=70.\+0f, float height=1.\+7f)
\begin{DoxyCompactList}\small\item\em Conduct View Analysis and access the results of every ray casted for every node. \end{DoxyCompactList}\item 
static \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_direction_array}{Direction\+Array}} \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_abc1d51bdf752a4fa36af012e90cc8acb}{Spherically\+Distribute\+Rays}} (int num\+\_\+rays, float upward\+\_\+fov=50f, float downward\+\_\+fov=70f)
\begin{DoxyCompactList}\small\item\em Distribute a set of points equally on a unit sphere. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Functions for analyzing the view of an observer in an environment at human scale. 

\begin{DoxyNote}{Note}
All of these functions internally use a raytracer, so a \mbox{\hyperlink{class_human_factors_1_1_ray_tracing_1_1_embree_b_v_h}{Human\+Factors.\+Ray\+Tracing.\+Embree\+B\+VH}} is required. 
\end{DoxyNote}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_human_factors_1_1_view_analysis_1_1_view_analysis_abc1d51bdf752a4fa36af012e90cc8acb}\label{class_human_factors_1_1_view_analysis_1_1_view_analysis_abc1d51bdf752a4fa36af012e90cc8acb}} 
\index{HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}!SphericallyDistributeRays@{SphericallyDistributeRays}}
\index{SphericallyDistributeRays@{SphericallyDistributeRays}!HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}}
\doxysubsubsection{\texorpdfstring{SphericallyDistributeRays()}{SphericallyDistributeRays()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_direction_array}{Direction\+Array}} Human\+Factors.\+View\+Analysis.\+View\+Analysis.\+Spherically\+Distribute\+Rays (\begin{DoxyParamCaption}\item[{int}]{num\+\_\+rays,  }\item[{float}]{upward\+\_\+fov = {\ttfamily 50f},  }\item[{float}]{downward\+\_\+fov = {\ttfamily 70f} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Distribute a set of points equally on a unit sphere. 


\begin{DoxyParams}{Parameters}
{\em num\+\_\+rays} & The number of points to distribute. \\
\hline
{\em upward\+\_\+fov} & Maximum angle above the sphere to generate points in degrees, \\
\hline
{\em downward\+\_\+fov} & Maximum angle in degrees downwards to generate.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An array of equally distributed points on a unit sphere.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
The number of rays casted may not exactly match {\ttfamily ray\+\_\+count} depending on the provided field of view restrictions.
\end{DoxyWarning}
\begin{DoxyNote}{Note}
This is the same function used internally by view analysis to equally distribute ray directions.
\end{DoxyNote}
\begin{DoxyParagraph}{Example}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Equally distribute 10 rays}}
\DoxyCodeLine{            var results = \mbox{\hyperlink{namespace_human_factors}{HumanFactors}}.\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_abc1d51bdf752a4fa36af012e90cc8acb}{SphericallyDistributeRays}}(10);}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Print results}}
\DoxyCodeLine{            Debug.WriteLine(results);}
\DoxyCodeLine{}
\end{DoxyCodeInclude}
{\ttfamily \mbox{[}0, -\/1, 0, -\/0.\+2650034, -\/0.\+8181818, . . . -\/0.\+7649929, 0.\+4396428, 0.\+8181818, 0.\+3705303\mbox{]}} 
\end{DoxyParagraph}
\mbox{\Hypertarget{class_human_factors_1_1_view_analysis_1_1_view_analysis_a1cdb30c740e2efd5a1a01ef633c734ac}\label{class_human_factors_1_1_view_analysis_1_1_view_analysis_a1cdb30c740e2efd5a1a01ef633c734ac}} 
\index{HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}!ViewAnalysisAggregate@{ViewAnalysisAggregate}}
\index{ViewAnalysisAggregate@{ViewAnalysisAggregate}!HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}}
\doxysubsubsection{\texorpdfstring{ViewAnalysisAggregate()}{ViewAnalysisAggregate()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{class_human_factors_1_1_native_utils_1_1_common_native_arrays_1_1_managed_float_array}{Managed\+Float\+Array}} Human\+Factors.\+View\+Analysis.\+View\+Analysis.\+View\+Analysis\+Aggregate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_human_factors_1_1_ray_tracing_1_1_embree_b_v_h}{Embree\+B\+VH}}}]{bvh,  }\item[{I\+Enumerable$<$ \mbox{\hyperlink{struct_human_factors_1_1_vector3_d}{Vector3D}} $>$}]{nodes,  }\item[{int}]{ray\+\_\+count,  }\item[{float}]{upward\+\_\+fov = {\ttfamily 50.0f},  }\item[{float}]{downward\+\_\+fov = {\ttfamily 70.0f},  }\item[{float}]{height = {\ttfamily 1.7f},  }\item[{\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765c}{View\+Aggregate\+Type}}}]{type = {\ttfamily \mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765ca16de38737a9f8366e9b2042b4e9b6290}{View\+Aggregate\+Type.\+A\+V\+E\+R\+A\+GE}}} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Conduct view analysis and aggregate the results for each node. 


\begin{DoxyParams}{Parameters}
{\em bvh} & the \mbox{\hyperlink{namespace_human_factors_1_1_geometry}{Geometry}} to intersect with. \\
\hline
{\em nodes} & Observer locations to perform view analysis from. \\
\hline
{\em ray\+\_\+count} & Number of rays to fire. Higher values provide more accurate analysis, but increase the runtime of this function \\
\hline
{\em upward\+\_\+fov} & Maximum angle in degrees above the viewer\textquotesingle{}s eye level that is considered. \\
\hline
{\em downward\+\_\+fov} & Maximum angle in degrees below the viewer\textquotesingle{}s eye level that is considered. \\
\hline
{\em height} & Height of the observer. Nodes are offset this distance from the ground before the analysis is performed. \\
\hline
{\em type} & How the distances for all hits should be aggregated. See \mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765c}{View\+Aggregate\+Type}} for a list of all aggregation methods.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An ordered array of floats corresponding to the aggregated score for each node in nodes.
\end{DoxyReturn}
The rays for each node will be casted in parallel using all available cores on the host\textquotesingle{}s machine.

\begin{DoxyRemark}{Remarks}
This function is much lighter in memory than \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_aec86f6a5bbc392de04357465994bab39}{View\+Analysis\+Standard}} since all operations are done in place on single floats. Use this as a faster alternative if the scores of nodes are all that\textquotesingle{}s needed.
\end{DoxyRemark}
\begin{DoxyParagraph}{Examples}

\end{DoxyParagraph}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{            \textcolor{comment}{// Load the plane .obj from example models, and rotate it from y-\/up to z-\/up}}
\DoxyCodeLine{            \textcolor{keywordtype}{string} mesh\_path = \textcolor{stringliteral}{"ExampleModels/plane.obj"};}
\DoxyCodeLine{            MeshInfo OBJ = OBJLoader.LoadOBJ(mesh\_path, CommonRotations.Zup\_To\_Yup);}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Create a BVH from the plane}}
\DoxyCodeLine{            EmbreeBVH bvh = \textcolor{keyword}{new} EmbreeBVH(OBJ);}
\DoxyCodeLine{}
\DoxyCodeLine{            Vector3D Point = \textcolor{keyword}{new} Vector3D(0, 0, 0);}
\DoxyCodeLine{            Vector3D[] nodes = \{ Point \};}
\DoxyCodeLine{            \textcolor{keywordtype}{int} num\_rays = 1000;}
\DoxyCodeLine{}
\end{DoxyCodeInclude}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Define the nodes to evaluate}}
\DoxyCodeLine{            Vector3D[] nodes = \{}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(0,0,1),}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(0,0,2),}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(0,0,3)}
\DoxyCodeLine{            \};}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Set maximum number of rays, then conduct analysis}}
\DoxyCodeLine{            \textcolor{keywordtype}{int} num\_rays = 1000;}
\DoxyCodeLine{            ManagedFloatArray results = \mbox{\hyperlink{namespace_human_factors}{HumanFactors}}.\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_a1cdb30c740e2efd5a1a01ef633c734ac}{ViewAnalysisAggregate}}(}
\DoxyCodeLine{                bvh,}
\DoxyCodeLine{                nodes,}
\DoxyCodeLine{                num\_rays,}
\DoxyCodeLine{                type:\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis_ae24b8f5d9783a270e51183ff2eca765c}{ViewAggregateType}}.COUNT}
\DoxyCodeLine{            );}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Print results. The number of rays should get lower with each element, since each node}}
\DoxyCodeLine{            \textcolor{comment}{// is further away from the plane than the last}}
\DoxyCodeLine{            Debug.WriteLine(results);}
\DoxyCodeLine{}
\end{DoxyCodeInclude}
{\ttfamily \mbox{[}480, 451, 428\mbox{]}} 

Referenced by String\+To\+Edge\+Cost.\+Main().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_human_factors_1_1_view_analysis_1_1_view_analysis_a1cdb30c740e2efd5a1a01ef633c734ac_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{class_human_factors_1_1_view_analysis_1_1_view_analysis_aec86f6a5bbc392de04357465994bab39}\label{class_human_factors_1_1_view_analysis_1_1_view_analysis_aec86f6a5bbc392de04357465994bab39}} 
\index{HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}!ViewAnalysisStandard@{ViewAnalysisStandard}}
\index{ViewAnalysisStandard@{ViewAnalysisStandard}!HumanFactors.ViewAnalysis.ViewAnalysis@{HumanFactors.ViewAnalysis.ViewAnalysis}}
\doxysubsubsection{\texorpdfstring{ViewAnalysisStandard()}{ViewAnalysisStandard()}}
{\footnotesize\ttfamily static \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_result_array}{Result\+Array}} Human\+Factors.\+View\+Analysis.\+View\+Analysis.\+View\+Analysis\+Standard (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_human_factors_1_1_ray_tracing_1_1_embree_b_v_h}{Embree\+B\+VH}}}]{bvh,  }\item[{I\+Enumerable$<$ \mbox{\hyperlink{struct_human_factors_1_1_vector3_d}{Vector3D}} $>$}]{nodes,  }\item[{int}]{ray\+\_\+count,  }\item[{float}]{upward\+\_\+fov = {\ttfamily 50.0f},  }\item[{float}]{downward\+\_\+fov = {\ttfamily 70.0f},  }\item[{float}]{height = {\ttfamily 1.7f} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Conduct View Analysis and access the results of every ray casted for every node. 


\begin{DoxyParams}{Parameters}
{\em bvh} & \mbox{\hyperlink{namespace_human_factors_1_1_geometry}{Geometry}} to intersect with. \\
\hline
{\em nodes} & Observer locations to perform view analysis from. \\
\hline
{\em ray\+\_\+count} & Number of rays to fire.\+Higher values provide more accurate analysis, but increase the runtime and memory consumption of this function. \\
\hline
{\em upward\+\_\+fov} & Maximum angle in degrees above the viewer\textquotesingle{}s eye level that is considered. \\
\hline
{\em downward\+\_\+fov} & Maximum angle in degrees below the viewer\textquotesingle{}s eye level that is considered. \\
\hline
{\em height} & Height of the observer. Nodes are offset this distance from the ground before the analysis is performed.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A {\ttfamily nodes.\+Count()} by {\ttfamily num\+\_\+rays} 2 dimensional array of results for each node and each ray casted. For example, every ray for node one is located at row 1, and the results for every ray casted from node 2 are located at row 2.
\end{DoxyReturn}
The rays for each node will be casted in parallel using all available cores on the host\textquotesingle{}s machine.

\begin{DoxyWarning}{Warning}
The number of rays casted may not exactly match ray\+\_\+count depending on the provided field of view restrictions.
\end{DoxyWarning}
\begin{DoxyNote}{Note}
The hitpoints for each ray in the returned array can be determined using the directions \mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_abc1d51bdf752a4fa36af012e90cc8acb}{Spherically\+Distribute\+Rays()}} with the same fov and ray\+\_\+count parameters. Failures to intersect geometry will return -\/1.
\end{DoxyNote}
\begin{DoxyParagraph}{Example}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{            \textcolor{comment}{// Load the plane .obj from example models, and rotate it from y-\/up to z-\/up}}
\DoxyCodeLine{            \textcolor{keywordtype}{string} mesh\_path = \textcolor{stringliteral}{"ExampleModels/plane.obj"};}
\DoxyCodeLine{            MeshInfo OBJ = OBJLoader.LoadOBJ(mesh\_path, CommonRotations.Zup\_To\_Yup);}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Create a BVH from the plane}}
\DoxyCodeLine{            EmbreeBVH bvh = \textcolor{keyword}{new} EmbreeBVH(OBJ);}
\DoxyCodeLine{}
\DoxyCodeLine{            Vector3D Point = \textcolor{keyword}{new} Vector3D(0, 0, 0);}
\DoxyCodeLine{            Vector3D[] nodes = \{ Point \};}
\DoxyCodeLine{            \textcolor{keywordtype}{int} num\_rays = 1000;}
\DoxyCodeLine{}
\end{DoxyCodeInclude}

\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{            \textcolor{comment}{// Define the nodes to evaluate}}
\DoxyCodeLine{            Vector3D[] nodes = \{}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(0,0,1),}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(1,1,1),}
\DoxyCodeLine{                \textcolor{keyword}{new} Vector3D(0,0,3)}
\DoxyCodeLine{            \};}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Set maximum number of rays, then conduct analysis}}
\DoxyCodeLine{            \textcolor{keywordtype}{int} num\_rays = 10;}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Conduct view analysis and get all the results}}
\DoxyCodeLine{            var results = \mbox{\hyperlink{namespace_human_factors}{HumanFactors}}.\mbox{\hyperlink{namespace_human_factors_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis}{ViewAnalysis}}.\mbox{\hyperlink{class_human_factors_1_1_view_analysis_1_1_view_analysis_aec86f6a5bbc392de04357465994bab39}{ViewAnalysisStandard}}(bvh, nodes, num\_rays);}
\DoxyCodeLine{}
\DoxyCodeLine{            \textcolor{comment}{// Iterate through every node and print the results}}
\DoxyCodeLine{            \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} node\_index = 0; node\_index < nodes.Length; node\_index++)}
\DoxyCodeLine{            \{}
\DoxyCodeLine{                var node = nodes[node\_index];}
\DoxyCodeLine{                \textcolor{keywordtype}{string} print = node.ToString() + \textcolor{stringliteral}{": ("};}
\DoxyCodeLine{                \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ray\_index = 0; ray\_index < num\_rays; ray\_index++)}
\DoxyCodeLine{                \{}
\DoxyCodeLine{                    \textcolor{comment}{// Get the result for the current node at the current ray}}
\DoxyCodeLine{                    var result = results[node\_index][ray\_index];}
\DoxyCodeLine{                    print += result.ToString();}
\DoxyCodeLine{}
\DoxyCodeLine{                    \textcolor{comment}{// Add a comma if it isn't the last element}}
\DoxyCodeLine{                    \textcolor{keywordflow}{if} (ray\_index != num\_rays -\/ 1)}
\DoxyCodeLine{                        print += \textcolor{stringliteral}{", "};}
\DoxyCodeLine{                    \textcolor{keywordflow}{else}}
\DoxyCodeLine{                        print += \textcolor{stringliteral}{")"};}
\DoxyCodeLine{                \}}
\DoxyCodeLine{                \textcolor{comment}{// Print the line}}
\DoxyCodeLine{                Debug.WriteLine(print);}
\DoxyCodeLine{                    }
\DoxyCodeLine{            \}}
\DoxyCodeLine{}
\end{DoxyCodeInclude}
 
\begin{DoxyCode}{0}
\DoxyCodeLine{(0, 0, 1): ([-\/1, -\/1], [5.292, 0], [-\/1, -\/1], [-\/1, -\/1], [3.098, 0], [5.407, 0], [13.07, 0], [-\/1, -\/1], [3.529, 0], [-\/1, -\/1])}
\DoxyCodeLine{(1, 1, 1): ([-\/1, -\/1], [5.292, 0], [-\/1, -\/1], [-\/1, -\/1], [3.098, 0], [5.407, 0], [13.07, 0], [-\/1, -\/1], [3.529, 0], [-\/1, -\/1])}
\DoxyCodeLine{(0, 0, 3): ([-\/1, -\/1], [9.211, 0], [-\/1, -\/1], [-\/1, -\/1], [5.394, 0], [9.413, 0], [-\/1, -\/1], [-\/1, -\/1], [6.144, 0], [-\/1, -\/1])}
\end{DoxyCode}
 
\end{DoxyParagraph}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/\+Csharp/packages/viewanalysis/src/View\+Analysis.\+cs\end{DoxyCompactItemize}
